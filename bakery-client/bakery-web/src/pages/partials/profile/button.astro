---
import type { User } from '@/lib/user/types';
import ProfileButton from '@user/components/buttons/ProfileButton';

let profileImg: string | undefined;
let alt: string = 'GE';
try {
  const req = await fetch('http://localhost:4321/api/users/me', {
    headers: {
      'Content-Type': 'application/json',
    },
    method: 'GET',
  });

  if (req.ok) {
    const res: User = await req.json();
    profileImg = res.profileImg;
    alt = `${res.firstName.at(0)?.toUpperCase()}${res.lastName.at(0)?.toUpperCase()}`;
  }
} catch (e) {
  profileImg = undefined;
  console.error(e);
}
---

<ProfileButton profileImg={profileImg} alt={alt} client:load />
